# מדריך התאמת עוגיות לתיקון 13 לחוק הגנת הפרטיות

## תוכן עניינים
1. [סקירה כללית](#סקירה-כללית)
2. [דרישות תיקון 13](#דרישות-תיקון-13)
3. [התקנת מערכת ההסכמה](#התקנת-מערכת-ההסכמה)
4. [תצורה והתאמה אישית](#תצורה-והתאמה-אישית)
5. [בונה באנר ההסכמה](#בונה-באנר-ההסכמה)
6. [בדיקת תאימות](#בדיקת-תאימות)
7. [שאלות נפוצות](#שאלות-נפוצות)

## סקירה כללית

תיקון 13 לחוק הגנת הפרטיות, שנכנס לתוקף באוגוסט 2025, מחייב אתרי אינטרנט ישראליים לקבל הסכמה מפורשת ומדעת מהמשתמשים לפני שימוש בעוגיות למטרות שאינן חיוניות לתפקוד האתר.

מערכת ה-Cookie Consent שפיתחנו מספקת פתרון מלא ותואם לדרישות החוק, כולל:
- ✅ הסכמה מפורשת לפני הפעלת עוגיות
- ✅ אפשרות דחייה ברורה
- ✅ בחירה גרנולרית של קטגוריות
- ✅ מנגנון ביטול הסכמה
- ✅ רישום ותיעוד הסכמות
- ✅ תמיכה מלאה בעברית ו-RTL

## דרישות תיקון 13

### 1. הסכמה מפורשת ומדעת
- **לפני הפעלת עוגיות**: אסור להפעיל עוגיות לא-חיוניות לפני קבלת הסכמה
- **מידע ברור**: יש להציג למשתמש מידע ברור על סוגי העוגיות והשימוש בהן
- **פעולה אקטיבית**: ההסכמה חייבת להינתן בפעולה אקטיבית (לחיצה על כפתור)

### 2. אפשרות דחייה
- **כפתור דחייה בולט**: חייב להיות כפתור ברור לדחיית כל העוגיות הלא-חיוניות
- **המשך גלישה**: המשתמש צריך להיות מסוגל להמשיך לגלוש באתר גם אם דחה עוגיות

### 3. בחירה גרנולרית
- **קטגוריות נפרדות**: הפרדה בין סוגי עוגיות (חיוניות, תפקודיות, אנליטיקס, שיווק)
- **בחירה פרטנית**: אפשרות לאשר/לדחות כל קטגוריה בנפרד

### 4. ביטול הסכמה
- **נגישות מתמדת**: אפשרות לבטל או לשנות הסכמה בכל עת
- **תהליך פשוט**: ביטול ההסכמה צריך להיות פשוט כמו מתן ההסכמה

### 5. תיעוד ושמירת נתונים
- **חותמת זמן**: רישום מתי ניתנה ההסכמה
- **גרסת הסכמה**: תיעוד גרסת מדיניות העוגיות
- **שמירת העדפות**: שמירת העדפות המשתמש לתקופה סבירה (עד שנה)

## התקנת מערכת ההסכמה

### שלב 1: הוספת הקבצים לאתר

```html
<!-- בתוך ה-<head> של האתר -->
<link rel="stylesheet" href="assets/vendor/cookieconsent/cookieconsent.css">
```

### שלב 2: הוספת הסקריפט

```html
<!-- לפני סגירת ה-</body> -->
<script type="module">
    import './assets/vendor/cookieconsent/cookieconsent.esm.js';
    import heTranslations from './assets/translations/he.json' assert { type: 'json' };
    
    window.CookieConsent.run({
        // התצורה המלאה - ראה בהמשך
    });
</script>
```

### שלב 3: תצורה בסיסית

```javascript
window.CookieConsent.run({
    cookie: {
        name: 'tikun13_cc',
        expiresAfterDays: 365
    },
    
    guiOptions: {
        consentModal: {
            layout: 'box',
            position: 'bottom center'
        }
    },
    
    categories: {
        necessary: {
            enabled: true,
            readOnly: true
        },
        analytics: {
            enabled: false,
            readOnly: false
        }
    },
    
    language: {
        default: 'he',
        translations: {
            he: heTranslations
        }
    }
});
```

## תצורה והתאמה אישית

### קטגוריות עוגיות

המערכת תומכת ב-4 קטגוריות עיקריות:

#### 1. עוגיות חיוניות (Necessary)
```javascript
necessary: {
    enabled: true,  // תמיד פעילות
    readOnly: true, // לא ניתן לבטל
    services: {
        essential: {
            label: 'שירותים חיוניים',
            description: 'עוגיות הכרחיות לתפקוד האתר'
        }
    }
}
```

#### 2. עוגיות תפקודיות (Functionality)
```javascript
functionality: {
    enabled: false,
    readOnly: false,
    autoClear: {
        cookies: [
            { name: /^language_preference/ },
            { name: /^theme_preference/ }
        ]
    }
}
```

#### 3. עוגיות אנליטיקס (Analytics)
```javascript
analytics: {
    enabled: false,
    readOnly: false,
    autoClear: {
        cookies: [
            { name: '_ga', domain: '.'+location.hostname },
            { name: /^_ga_/, domain: '.'+location.hostname }
        ]
    }
}
```

#### 4. עוגיות שיווק (Marketing)
```javascript
marketing: {
    enabled: false,
    readOnly: false,
    autoClear: {
        cookies: [
            { name: /^_fbp$/ },
            { name: /^_gcl_/ }
        ]
    }
}
```

### התאמת העיצוב

#### ערכות נושא מובנות
```javascript
// הפעלת מצב כהה
document.documentElement.classList.add('cc--darkmode');
```

#### CSS מותאם אישית
```css
/* שינוי צבעי הבאנר */
.cc-modal {
    --cc-bg: #ffffff;
    --cc-text: #333333;
    --cc-btn-primary-bg: #667eea;
    --cc-btn-primary-text: #ffffff;
}
```

### פונקציות Callback

```javascript
onFirstConsent: function({cookie}) {
    console.log('הסכמה ראשונה נרשמה', cookie);
    // רישום להיסטוריה
},

onConsent: function({cookie}) {
    console.log('הסכמה עודכנה', cookie);
    // עדכון העדפות
},

onChange: function({cookie, changedCategories}) {
    console.log('העדפות שונו', changedCategories);
    // טיפול בשינויים
}
```

## בונה באנר ההסכמה

השתמשו בכלי הבונה האינטראקטיבי שלנו ליצירת באנר מותאם אישית:

### גישה לבונה
1. בעמוד הראשי, לחצו על "בונה באנר עוגיות" בתפריט או בסרגל המעבר בין הכלים
2. הגדירו את ההעדפות שלכם
3. צפו בתצוגה מקדימה בזמן אמת
4. ייצאו את הקוד המוכן

### תכונות הבונה
- ✨ ממשק גרירה ושחרור
- 🎨 עיצוב מותאם אישית
- 📝 עריכת טקסטים בעברית
- 📋 ייצוא קוד מוכן
- 📦 הורדת חבילה מלאה

## בדיקת תאימות

### שימוש בסורק האוטומטי

הסורק שלנו בודק אוטומטית את הקריטריונים הבאים:

1. **נוכחות באנר הסכמה**
   - חיפוש אלמנטים של cookie consent
   - בדיקת טקסטים רלוונטיים

2. **אפשרות דחייה**
   - חיפוש כפתורי דחייה
   - בדיקת פונקציונליות

3. **בחירה גרנולרית**
   - זיהוי קטגוריות נפרדות
   - בדיקת checkboxes

4. **ביטול הסכמה**
   - חיפוש מנגנון ביטול
   - בדיקת נגישות

5. **תכונות מתקדמות**
   - רישום חותמת זמן
   - ניהול גרסאות
   - יצוא נתונים

### בדיקה ידנית

```javascript
// בדיקת סטטוס הסכמה
console.log(CookieConsent.getCookie());

// בדיקת קטגוריה ספציפית
console.log(CookieConsent.acceptedCategory('analytics'));

// ביטול הסכמה
CookieConsent.reset();
```

## שאלות נפוצות

### ש: האם המערכת תואמת GDPR?
**ת:** כן, המערכת תואמת גם GDPR וגם תיקון 13. היא מכסה את כל הדרישות של שני התקנים.

### ש: איך מטפלים בגולשים עם חוסמי פרסומות?
**ת:** המערכת פועלת גם עם חוסמי פרסומות כי היא לא משתמשת בשירותי צד שלישי.

### ש: כמה זמן נשמרת ההסכמה?
**ת:** ברירת המחדל היא שנה (365 ימים), אך ניתן להתאים זאת בתצורה.

### ש: האם צריך לשמור logs של הסכמות?
**ת:** תיקון 13 לא מחייב זאת במפורש, אך מומלץ לשמור תיעוד בסיסי למקרה של בירור.

### ש: מה קורה אם המשתמש דוחה את כל העוגיות?
**ת:** האתר צריך להמשיך לפעול עם עוגיות חיוניות בלבד. פונקציונליות מתקדמת עשויה להיות מוגבלת.

### ש: איך מעדכנים את מדיניות העוגיות?
**ת:** יש להעלות את מספר הגרסה (revision) בתצורה. המערכת תבקש אוטומטית הסכמה מחדש.

## תמיכה ועזרה

### קישורים שימושיים
- 📚 [תיעוד מלא של CookieConsent](https://cookieconsent.orestbida.com)
- 🔗 [GitHub Repository](https://github.com/nirhalfon/Tikun13checker)
- 📧 [צור קשר](mailto:info@ionsec.io)

### דיווח על בעיות
אם נתקלתם בבעיה, אנא:
1. בדקו את ה-Console בדפדפן
2. וודאו שכל הקבצים נטענו כראוי
3. בדקו שאין התנגשויות עם סקריפטים אחרים
4. פתחו Issue ב-GitHub עם פרטים מלאים

## הערות משפטיות

⚠️ **אזהרה חשובה**: מדריך זה מספק הנחיות טכניות בלבד ואינו מהווה ייעוץ משפטי. יש להיוועץ בעורך דין המתמחה בדיני פרטיות וטכנולוגיה לצורך עמידה מלאה בדרישות החוק.

---

*מדריך זה עודכן לאחרונה: אוגוסט 2024*
*גרסת תיקון 13: 1.0.0*